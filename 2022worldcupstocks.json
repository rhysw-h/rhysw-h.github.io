{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "description": "Stock price comparison",
  "title": {
    "text": "Stock prices of 2022 World Cup sponsors",
    "subtitle": "Source: yfinance API"
  },
  "data": {
    "url": "https://raw.githubusercontent.com/rhysw-h/rhysw-h.github.io/refs/heads/main/2022wcstocks_rebased.csv"
  },
  "width": 400,
  "height": 400,
  "layer": [
    {
      "data": {
        "values": [{"start": "2022-11-20", "end": "2022-12-18"}]
      },
      "mark": {
        "type": "rect",
        "opacity": 0.3,
        "color": "grey",
        "tooltip": {"content": "data"}
      },
      "encoding": {
        "x": {"field": "start", "type": "temporal"},
        "x2": {"field": "end", "type": "temporal"},
        "tooltip": [
          {"value": "Period of World Cup", "title": ""}
        ]
      }
    },
    {
      "transform": [
        {"filter": "datum['ADS\\.DE'] != 0"},
        {"filter": "datum['005380\\.KS'] != 0"},
        {"filter": "datum['KO'] != 0"},
        {"filter": "datum['V'] != 0"}
      ],
      "encoding": {
        "x": {"field": "Date", "type": "temporal", "title": null},
        "tooltip": [
          {"field": "Date", "type": "temporal", "title": "Date"},
          {"field": "ADS\\.DE", "type": "quantitative", "title": "Adidas"},
          {"field": "005380\\.KS", "type": "quantitative", "title": "Hyundai"},
          {"field": "KO", "type": "quantitative", "title": "Coca-Cola"},
          {"field": "V", "type": "quantitative", "title": "Visa"}
        ]
      },
      "layer": [
        {
          "mark": {"type": "line", "point": {"size": 10}},
          "encoding": {
            "y": {
              "field": "ADS\\.DE",
              "type": "quantitative",
              "title": "Stock Prices (Rebased to 100)"
            },
            "color": {"value": "#0000FF"}
          }
        },
        {
          "mark": {"type": "line", "point": {"size": 10}},
          "encoding": {
            "y": {"field": "005380\\.KS", "type": "quantitative"},
            "color": {"value": "#FF0000"}
          }
        },
        {
          "mark": {"type": "line", "point": {"size": 10}},
          "encoding": {
            "y": {"field": "KO", "type": "quantitative"},
            "color": {"value": "#00FF00"}
          }
        },
        {
          "mark": {"type": "line", "point": {"size": 10}},
          "encoding": {
            "y": {"field": "V", "type": "quantitative"},
            "color": {"value": "#FFA500"}
          }
        }
      ]
    }
  ],
  "config": {
    "legend": {
      "title": null,
      "labelExpr": "datum.label == 'ADS\\.DE' ? 'Adidas' : datum.label == '005380\\.KS' ? 'Hyundai' : datum.label == 'KO' ? 'Coca-Cola' : 'Visa'"
    }
  }
}
